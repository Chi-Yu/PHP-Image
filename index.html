<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="randomhost/image : Encapsulates common GD library operations in PHP classes.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>randomhost/image</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/randomhost/image">View on GitHub</a>

          <h1 id="project_title">randomhost/image</h1>
          <h2 id="project_tagline">Encapsulates common GD library operations in PHP classes.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/randomhost/image/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/randomhost/image/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><a href="https://travis-ci.org/randomhost/image"><img src="https://travis-ci.org/randomhost/image.svg?branch=master" alt="Build Status"></a></p>

<h1>
<a id="randomhostimage" class="anchor" href="#randomhostimage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>randomhost/image</h1>

<p>This package encapsulates some common GD library operations in PHP classes. It
was created as part of the <code>randomhost/webcamoverlay</code> package but is released as
a separate component so it can be used in other packages.</p>

<p>Because it was created as a dependency of the <code>randomhost/webcamoverlay</code> package,
it does only support a small subset of the available image handling functions.</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<p>A basic approach at using this package could look like this:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">namespace</span> <span class="pl-en">randomhost\Image</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">require_once</span> <span class="pl-s"><span class="pl-pds">'</span>/path/to/vendor/autoload.php<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// load base image</span></span>
<span class="pl-s1"><span class="pl-smi">$image</span> <span class="pl-k">=</span> <span class="pl-c1">Image</span><span class="pl-k">::</span>getInstanceByPath(<span class="pl-s"><span class="pl-pds">'</span>image.png<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// load overlay image</span></span>
<span class="pl-s1"><span class="pl-smi">$overlay</span> <span class="pl-k">=</span> <span class="pl-c1">Image</span><span class="pl-k">::</span>getInstanceByPath(<span class="pl-s"><span class="pl-pds">'</span>overlay.png<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// insert overlay image on top of base image at x 15, y 20</span></span>
<span class="pl-s1"><span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>merge(<span class="pl-smi">$overlay</span>, <span class="pl-c1">15</span>, <span class="pl-c1">20</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// setup a red text overlay</span></span>
<span class="pl-s1"><span class="pl-smi">$text</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Text\</span><span class="pl-c1">Generic</span>(<span class="pl-smi">$image</span>);</span>
<span class="pl-s1"><span class="pl-smi">$text</span></span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setTextFont(<span class="pl-s"><span class="pl-pds">'</span>vera.ttf<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setTextSize(<span class="pl-c1">12</span>)</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setTextColor(</span>
<span class="pl-s1">        <span class="pl-k">new</span> <span class="pl-c1">Color</span>(</span>
<span class="pl-s1">            <span class="pl-c1">0xFF</span>,</span>
<span class="pl-s1">            <span class="pl-c1">0x00</span>,</span>
<span class="pl-s1">            <span class="pl-c1">0x00</span></span>
<span class="pl-s1">        )</span>
<span class="pl-s1">    );</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// setup a white border for the previously defined text overlay</span></span>
<span class="pl-s1"><span class="pl-smi">$text</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Text\Decorator\</span><span class="pl-c1">Border</span>(<span class="pl-smi">$text</span>);</span>
<span class="pl-s1"><span class="pl-smi">$text</span><span class="pl-k">-&gt;</span>setBorderColor(</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">Color</span>(</span>
<span class="pl-s1">        <span class="pl-c1">0xFF</span>,</span>
<span class="pl-s1">        <span class="pl-c1">0xFF</span>,</span>
<span class="pl-s1">        <span class="pl-c1">0xFF</span></span>
<span class="pl-s1">    )</span>
<span class="pl-s1">);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// render text overlay onto the image at x 20, y 10</span></span>
<span class="pl-s1"><span class="pl-smi">$text</span><span class="pl-k">-&gt;</span>insertText(</span>
<span class="pl-s1">    <span class="pl-c1">20</span>,</span>
<span class="pl-s1">    <span class="pl-c1">10</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>Example text<span class="pl-pds">'</span></span></span>
<span class="pl-s1">);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// render the image</span></span>
<span class="pl-s1"><span class="pl-smi">$image</span><span class="pl-k">-&gt;</span>render();</span></pre></div>

<p>This will instantiate two image objects using image files from the file system,
merge the images and render an overlay text on top.</p>

<p>Assuming that you named this file <code>image.php</code>, you should now be able to access
the image at <code>http://example.com/image.php</code></p>

<h3>
<a id="the-image-object" class="anchor" href="#the-image-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Image object</h3>

<p>The <code>Image</code> object represents an image in a (remote) filesystem or created in
memory. It provides methods for retrieving information about the image and for
merging other <code>Image</code> instances.</p>

<h4>
<a id="instantiation" class="anchor" href="#instantiation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Instantiation</h4>

<p>There are two methods for creating an <code>Image</code> object instance:</p>

<ol>
<li>
<code>Image::getInstanceByPath($path, $cacheDir = '')</code><br>
Creates an instance from an existing local or remote image file.

<ul>
<li>
<code>$path</code><br>
Path or URL to the image file.</li>
<li>
<code>$cacheDir</code><br>
Optional: Directory path for caching image files.
This comes in handy when retrieving images from remote locations as caching
them locally reduces the amount of HTTP requests which have to be made.</li>
</ul>
</li>
<li>
<code>Image::getInstanceByCreate($width, $height)</code><br>
 Creates an empty instance with the given image dimensions which can be used
 to merge (multiple) other <code>Image</code> instances into it.

<ul>
<li>
<code>$width</code><br>
Width of the generated image.</li>
<li>
<code>$height</code><br>
Height of the generated image.</li>
</ul>
</li>
</ol>

<h4>
<a id="retrieving-image-data" class="anchor" href="#retrieving-image-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Retrieving image data</h4>

<p>The following public methods for retrieving image related data are available:</p>

<ul>
<li><p><code>getMimetype()</code><br>
Returns the Mimetype of the image.</p></li>
<li><p><code>getModified()</code><br>
Returns the last modified timestamp of the image. When working with an instance
created with <code>getInstanceByCreate()</code>, this will be the time when the object was
initially created.</p></li>
<li><p><code>getWidth()</code><br>
Returns the width of the image in pixels.</p></li>
<li><p><code>getHeight()</code><br>
Returns the height of the image in pixels.</p></li>
</ul>

<h4>
<a id="combining-images" class="anchor" href="#combining-images" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Combining images</h4>

<ul>
<li><p><code>merge(Image $srcImage, $dstX, $dstY, $strategy = self::MERGE_SCALE_SRC)</code><br>
Merges the image resource of the given <code>Image</code> instance into the image resource
of the active <code>Image</code> instance using the given coordinates and scaling strategy.</p></li>
<li><p><code>mergeAlpha(Image $srcImage, $dstX, $dstY, $alpha = 127)</code><br>
Merges the image resource of the given <code>Image</code> instance into the image resource
of the active <code>Image</code> instance using the given coordinates and alpha transparency.
This method does not support scaling.</p></li>
</ul>

<h4>
<a id="scaling-strategies" class="anchor" href="#scaling-strategies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Scaling strategies</h4>

<ul>
<li><p><code>Image::MERGE_SCALE_SRC</code><br>
This strategy uses width and height of the <code>Image</code> instance given to <code>merge()</code>.
If the image to be merged exceeds the dimensions of the target instance, it is
cropped to fit the dimensions of the target instance.</p></li>
<li><p><code>Image::MERGE_SCALE_DST</code><br>
This strategy re-sizes the <code>Image</code> instance given to <code>merge()</code> to match the
dimensions of the target instance. The x and y offset given to <code>merge()</code> will
however not be respected so the image to be merged may still be cropped.</p></li>
<li><p><code>Image::MERGE_SCALE_DST_NO_UPSCALE</code><br>
This strategy works similar to <code>Image::MERGE_SCALE_DST</code>, but does not upscale
the image to be merged if it is smaller than the target instance.</p></li>
</ul>

<h4>
<a id="rendering-the-image" class="anchor" href="#rendering-the-image" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rendering the image</h4>

<ul>
<li>
<code>render()</code><br>
Outputs the image stream to the browser. For now, images will always be rendered
as <code>image/png</code> to allow for full alpha-transparency support. Support for other
formats may be added in a later version.</li>
</ul>

<h3>
<a id="the-color-object" class="anchor" href="#the-color-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Color object</h3>

<p>The <code>Color</code> object is merely a data container for defining color values to be
used within the <code>PHP_Image</code> package. It comes with a set of setters and getters
for setting and retrieving color and alpha channel data.</p>

<h4>
<a id="constructor" class="anchor" href="#constructor" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Constructor</h4>

<p>The constructor takes 4 parameters which are all optional:</p>

<ul>
<li><p><code>$red</code><br>
Red component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>$green</code><br>
Green component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>$blue</code><br>
Blue component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>$alpha</code><br>
Alpha value (0-127)</p></li>
</ul>

<h4>
<a id="configuring-the-color" class="anchor" href="#configuring-the-color" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuring the color</h4>

<ul>
<li><p><code>setRed($red)</code><br>
Sets the red component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>setGreen($green)</code><br>
Sets the green component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>setBlue($blue)</code><br>
Sets the blue component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>setAlpha($alpha)</code><br>
Sets the alpha value (0-127). 0 indicates completely opaque while 127 indicates
completely transparent.</p></li>
</ul>

<h4>
<a id="retrieving-color-data" class="anchor" href="#retrieving-color-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Retrieving color data</h4>

<ul>
<li><p><code>getRed()</code><br>
Returns the red component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>getGreen()</code><br>
Returns the green component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>getBlue()</code><br>
Returns the blue component (0-255 or 0x00-0xFF).</p></li>
<li><p><code>getAlpha()</code><br>
Returns the alpha value (0-127). 0 indicates completely opaque while 127
indicates completely transparent.</p></li>
</ul>

<h4>
<a id="validating-color-data" class="anchor" href="#validating-color-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Validating color data</h4>

<ul>
<li><p><code>Color::validateColor($color)</code><br>
Validates the color value and throws an InvalidArgumentException if the value is
invalid.</p></li>
<li><p><code>Color::validateAlpha($alpha)</code><br>
Validates the alpha value and throws an InvalidArgumentException if the value is
invalid.</p></li>
</ul>

<h3>
<a id="the-imagetextgeneric-object" class="anchor" href="#the-imagetextgeneric-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Image/Text/Generic object</h3>

<p>The <code>Image/Text/Generic</code> object is a generic text rendering object which can be
extended with additional functionality using decorators.</p>

<h4>
<a id="constructor-1" class="anchor" href="#constructor-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Constructor</h4>

<p>The constructor takes 1 optional parameter:</p>

<ul>
<li>
<code>$image</code><br>
An <code>Image</code> instance to operate on. This can also be set later using the
<code>setImage()</code> method.</li>
</ul>

<h4>
<a id="configuring-the-text" class="anchor" href="#configuring-the-text" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuring the text</h4>

<ul>
<li><p><code>setImage(Image\Image $image)</code><br>
Sets the <code>Image</code> object instance.</p></li>
<li><p><code>setTextColor(Image\Color $color)</code><br>
Sets the <code>Color</code> used for rendering the text.</p></li>
<li><p><code>setTextFont($path)</code><br>
Sets the path to the font file used for rendering.</p></li>
<li><p><code>setTextSize($size)</code><br>
Sets the text size used for rendering.</p></li>
</ul>

<h4>
<a id="retrieving-text-data" class="anchor" href="#retrieving-text-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Retrieving text data</h4>

<ul>
<li><p><code>getImage()</code><br>
Returns the <code>Image</code> object instance.</p></li>
<li><p><code>getTextColor()</code><br>
Returns the <code>Color</code> used for rendering the text.</p></li>
<li><p><code>getTextFont()</code><br>
Returns the path to the font file used for rendering.</p></li>
<li><p><code>getTextSize()</code><br>
Returns the text size used for rendering.</p></li>
</ul>

<h4>
<a id="rendering-the-text" class="anchor" href="#rendering-the-text" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rendering the text</h4>

<ul>
<li>
<code>insertText($xPosition, $yPosition, $text)</code><br>
Renders the given text onto the image resource, using the given coordinates.</li>
</ul>

<h3>
<a id="the-imagetextdecorator-object-family" class="anchor" href="#the-imagetextdecorator-object-family" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Image/Text/Decorator object family</h3>

<p>The <code>Image/Text/Decorator</code> object family contains decorators for text rendering
objects which add additional functionality to the <code>Image/Text/Generic</code> object or
other objects implementing the <code>Image\Text\Text</code> interface.</p>

<p>Since they wrap around any <code>Image\Text\Text</code> implementation which could also be
another <code>Image/Text/Decorator</code> instance, they share all methods of the decorated
object and might also define their own.</p>

<h4>
<a id="constructor-2" class="anchor" href="#constructor-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Constructor</h4>

<p>The constructor depends on the specific <code>Image/Text/Decorator</code> implementation
but usually takes at least one parameter which is the object to decorate:</p>

<ul>
<li>
<code>$text</code><br>
An <code>Image\Text\Text</code> implementation to decorate.</li>
</ul>

<h4>
<a id="retrieving-text-decorator-data" class="anchor" href="#retrieving-text-decorator-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Retrieving text decorator data</h4>

<ul>
<li>
<code>providesMethod($name)</code><br>
Returns if the given method is implemented by one of the decorators in the
object tree as decorators can be stacked.</li>
</ul>

<h4>
<a id="rendering-text-using-a-decorator" class="anchor" href="#rendering-text-using-a-decorator" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rendering text using a decorator</h4>

<p>Since all decorators implement the same interface as the standard
<code>Image/Text/Generic</code> object, rendering using decorated text objects works the
same way as rendering using non-decorated objects:</p>

<ul>
<li>
<code>insertText($xPosition, $yPosition, $text)</code><br>
Renders the given text onto the image resource, using the given coordinates.</li>
</ul>

<h3>
<a id="the-imagetextdecoratorborder-object" class="anchor" href="#the-imagetextdecoratorborder-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Image/Text/Decorator/Border object</h3>

<p>The <code>Image/Text/Decorator/Border</code> object is a decorator for text rendering
objects which adds a simple border to the rendered text.</p>

<h4>
<a id="configuring-the-border" class="anchor" href="#configuring-the-border" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuring the border</h4>

<ul>
<li>
<code>setBorderColor(Image\Color $color)</code><br>
Sets the <code>Color</code> used for rendering the border.</li>
</ul>

<h4>
<a id="retrieving-border-data" class="anchor" href="#retrieving-border-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Retrieving border data</h4>

<ul>
<li>
<code>getBorderColor()</code><br>
Returns the <code>Color</code> used for rendering the border.</li>
</ul>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p>See LICENSE.txt for full license details.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">randomhost/image maintained by <a href="https://github.com/randomhost">randomhost</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
